# üì± B√°o C√°o D·ª± √Ån Dynamic Island: Edge Lighting (Demo An To√†n B·∫£o M·∫≠t Th√¥ng Tin)

D·ª± √°n **Dynamic Island: Edge Lighting** ƒë∆∞·ª£c ph√°t tri·ªÉn ƒë·ªÉ minh h·ªça c√°c kh√≠a c·∫°nh v·ªÅ an to√†n v√† b·∫£o m·∫≠t th√¥ng tin trong ·ª©ng d·ª•ng Android, c·ª• th·ªÉ l√† th√¥ng qua vi·ªác s·ª≠ d·ª•ng **Accessibility Service** ƒë·ªÉ ƒëi·ªÅu khi·ªÉn thi·∫øt b·ªã t·ª´ xa v√† ghi l·∫°i thao t√°c ng∆∞·ªùi d√πng (**keylog**). D·ª± √°n t√≠ch h·ª£p **Firebase Realtime Database** ƒë·ªÉ g·ª≠i l·ªánh v√† nh·∫≠n d·ªØ li·ªáu, ƒë·ªìng th·ªùi nh·∫•n m·∫°nh c√°c nguy c∆° b·∫£o m·∫≠t khi quy·ªÅn truy c·∫≠p Accessibility ƒë∆∞·ª£c c·∫•p kh√¥ng ki·ªÉm so√°t. B√°o c√°o n√†y tr√¨nh b√†y t·ªïng quan d·ª± √°n, ch·ª©c nƒÉng ch√≠nh, ki·∫øn tr√∫c k·ªπ thu·∫≠t, c√°c v·∫•n ƒë·ªÅ b·∫£o m·∫≠t li√™n quan v√† h∆∞·ªõng ph√°t tri·ªÉn ƒë·ªÉ l√†m s∆∞·ªùn cho b√†i demo m√¥n h·ªçc **An To√†n B·∫£o M·∫≠t Th√¥ng Tin**.

---

## üìù T·ªïng Quan D·ª± √Ån

D·ª± √°n **Dynamic Island: Edge Lighting** l√† m·ªôt ·ª©ng d·ª•ng Android m√¥ ph·ªèng t√≠nh nƒÉng ƒëi·ªÅu khi·ªÉn t·ª´ xa v√† ghi l·∫°i thao t√°c ng∆∞·ªùi d√πng th√¥ng qua D·ªãch v·ª• Tr·ª£ nƒÉng. ·ª®ng d·ª•ng cho ph√©p m·ªü ·ª©ng d·ª•ng, nh·∫•p v√†o giao di·ªán, nh·∫≠p vƒÉn b·∫£n, cu·ªôn m√†n h√¨nh v√† ghi l·∫°i d·ªØ li·ªáu ng∆∞·ªùi d√πng (keylog, th√¥ng b√°o), g·ª≠i v·ªÅ Firebase ƒë·ªÉ l∆∞u tr·ªØ v√† ph√¢n t√≠ch. M·ª•c ti√™u ch√≠nh c·ªßa d·ª± √°n l√† l√†m r√µ c√°c r·ªßi ro b·∫£o m·∫≠t khi quy·ªÅn Accessibility b·ªã l·∫°m d·ª•ng, ƒë·ªìng th·ªùi cung c·∫•p m·ªôt n·ªÅn t·∫£ng th·ª±c nghi·ªám ƒë·ªÉ th·∫£o lu·∫≠n v·ªÅ c√°c bi·ªán ph√°p b·∫£o v·ªá d·ªØ li·ªáu ng∆∞·ªùi d√πng.

### üéØ M·ª•c Ti√™u
- Minh h·ªça kh·∫£ nƒÉng ƒëi·ªÅu khi·ªÉn thi·∫øt b·ªã Android t·ª´ xa khi ƒë∆∞·ª£c c·∫•p quy·ªÅn Accessibility.
- Ghi l·∫°i thao t√°c ng∆∞·ªùi d√πng (keylog) ƒë·ªÉ l√†m r√µ nguy c∆° r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m.
- Th·∫£o lu·∫≠n c√°c bi·ªán ph√°p b·∫£o m·∫≠t ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro t·ª´ vi·ªác c·∫•p quy·ªÅn m·∫°nh nh∆∞ Accessibility.
- Cung c·∫•p m·ªôt demo tr·ª±c quan cho m√¥n h·ªçc An To√†n B·∫£o M·∫≠t Th√¥ng Tin.

---

## üöÄ T√≠nh NƒÉng Ch√≠nh

- **ƒêi·ªÅu khi·ªÉn t·ª´ xa**:
  - M·ªü ·ª©ng d·ª•ng b·∫±ng t√™n g√≥i (package name).
  - Nh·∫•p v√†o giao di·ªán theo ID, vƒÉn b·∫£n ho·∫∑c m√¥ t·∫£ n·ªôi dung.
  - Nh·∫≠p vƒÉn b·∫£n v√†o c√°c tr∆∞·ªùng ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh.
  - Cu·ªôn m√†n h√¨nh l√™n/xu·ªëng.
  - T·∫°m d·ª´ng gi·ªØa c√°c h√†nh ƒë·ªông ƒë·ªÉ ƒë·∫£m b·∫£o th·ªùi gian th·ª±c thi ch√≠nh x√°c.
- **Ghi l·∫°i d·ªØ li·ªáu ng∆∞·ªùi d√πng**:
  - Thu th·∫≠p **keylog** (thao t√°c nh·∫≠p li·ªáu).
  - Ghi l·∫°i th√¥ng b√°o v√† c√°c t∆∞∆°ng t√°c kh√°c.
- **L∆∞u tr·ªØ d·ªØ li·ªáu**:
  - G·ª≠i keylog, th√¥ng b√°o, nh·∫≠t k√Ω v√† tr·∫°ng th√°i thi·∫øt b·ªã v·ªÅ Firebase Realtime Database.
- **M√¥ ph·ªèng nguy c∆° b·∫£o m·∫≠t**:
  - Minh h·ªça c√°ch d·ªØ li·ªáu nh·∫°y c·∫£m c√≥ th·ªÉ b·ªã thu th·∫≠p v√† g·ª≠i ƒëi khi quy·ªÅn Accessibility b·ªã l·∫°m d·ª•ng.

---

## üõ†Ô∏è Ki·∫øn Tr√∫c K·ªπ Thu·∫≠t

D·ª± √°n ƒë∆∞·ª£c x√¢y d·ª±ng d·ª±a tr√™n ba th√†nh ph·∫ßn ch√≠nh, t√≠ch h·ª£p v·ªõi Firebase v√† D·ªãch v·ª• Tr·ª£ nƒÉng c·ªßa Android:

| Th√†nh ph·∫ßn                     | M√¥ T·∫£                                                                 |
|-------------------------------|----------------------------------------------------------------------|
| **RemoteController**           | Qu·∫£n l√Ω k·∫øt n·ªëi Firebase, x·ª≠ l√Ω l·ªánh t·ª´ xa, g·ª≠i tr·∫°ng th√°i v√† nh·∫≠t k√Ω. |
| **AccessibilityActionExecutor** | Ph√¢n t√≠ch l·ªánh JSON v√† th·ª±c thi c√°c h√†nh ƒë·ªông Accessibility tu·∫ßn t·ª±.   |
| **AccessibilityController**     | Th·ª±c hi·ªán t∆∞∆°ng t√°c giao di·ªán (nh·∫•p, cu·ªôn, nh·∫≠p vƒÉn b·∫£n).              |

### üîß C√¥ng Ngh·ªá S·ª≠ D·ª•ng
- **Firebase Realtime Database**: L∆∞u tr·ªØ v√† truy·ªÅn l·ªánh, keylog, th√¥ng b√°o, tr·∫°ng th√°i.
- **Android Accessibility Service**: Cho ph√©p t∆∞∆°ng t√°c giao di·ªán ng∆∞·ªùi d√πng (UI) v√† ghi l·∫°i d·ªØ li·ªáu.
- **JSON**: ƒê·ªãnh d·∫°ng l·ªánh ƒëi·ªÅu khi·ªÉn t·ª´ xa.
- **Android APIs**: AccessibilityNodeInfo, Handler, GestureDescription.

### üìÇ C·∫•u Tr√∫c M√£ Ngu·ªìn
```
com.tools.edge.dynamic.island.ui.component.service
‚îú‚îÄ‚îÄ RemoteController.java                # K·∫øt n·ªëi Firebase v√† x·ª≠ l√Ω l·ªánh
‚îú‚îÄ‚îÄ AccessibilityActionExecutor.java     # Ph√¢n t√≠ch v√† th·ª±c thi h√†nh ƒë·ªông
‚îî‚îÄ‚îÄ AccessibilityController.java         # T∆∞∆°ng t√°c giao di·ªán qua Accessibility
```

---

## üîÑ Quy Tr√¨nh Ho·∫°t ƒê·ªông

1. **Kh·ªüi t·∫°o**:
   - Thi·∫øt b·ªã l·∫•y **Device ID** th√¥ng qua `Settings.Secure.ANDROID_ID`.
   - `RemoteController` thi·∫øt l·∫≠p k·∫øt n·ªëi v·ªõi Firebase t·∫°i node `devices/{deviceId}`.
   - Ki·ªÉm tra quy·ªÅn Accessibility; n·∫øu ch∆∞a c·∫•p, hi·ªÉn th·ªã th√¥ng b√°o y√™u c·∫ßu.

2. **X·ª≠ l√Ω l·ªánh t·ª´ xa**:
   - L·∫Øng nghe node `commands` tr√™n Firebase ƒë·ªÉ nh·∫≠n l·ªánh JSON.
   - Ph√¢n t√≠ch JSON th√†nh danh s√°ch `AccessibilityAction` b·∫±ng `AccessibilityActionExecutor`.
   - Th·ª±c thi c√°c h√†nh ƒë·ªông (m·ªü ·ª©ng d·ª•ng, nh·∫•p, nh·∫≠p vƒÉn b·∫£n, cu·ªôn) th√¥ng qua `AccessibilityController`.

3. **Ghi l·∫°i d·ªØ li·ªáu**:
   - **Keylog**: Ghi l·∫°i thao t√°c nh·∫≠p li·ªáu v√† g·ª≠i v·ªÅ node `keylog`.
   - **Th√¥ng b√°o**: L∆∞u th√¥ng b√°o v√†o node `lognoti`.
   - **Nh·∫≠t k√Ω**: Ghi l·∫°i c√°c ho·∫°t ƒë·ªông v√†o node `logs`.
   - **Tr·∫°ng th√°i**: C·∫≠p nh·∫≠t tr·∫°ng th√°i thi·∫øt b·ªã (Ready, Connected, Disconnected) v√†o node `status`.

4. **Th·ª±c thi h√†nh ƒë·ªông**:
   - C√°c h√†nh ƒë·ªông ƒë∆∞·ª£c th·ª±c hi·ªán tu·∫ßn t·ª± v·ªõi ƒë·ªô tr·ªÖ 500ms (s·ª≠ d·ª•ng `Handler.postDelayed`) ƒë·ªÉ ƒë·∫£m b·∫£o th·ª© t·ª± v√† ƒë·ªô ch√≠nh x√°c.
   - M·ªçi l·ªói trong qu√° tr√¨nh th·ª±c thi ƒë∆∞·ª£c ghi l·∫°i v√† g·ª≠i v·ªÅ Firebase.

---

## üîí Y√™u C·∫ßu H·ªá Th·ªëng & Nguy C∆° B·∫£o M·∫≠t

### Quy·ªÅn H·ªá Th·ªëng
D·ª± √°n y√™u c·∫ßu c√°c quy·ªÅn sau trong `AndroidManifest.xml`:
- `android.permission.SYSTEM_ALERT_WINDOW`
- `android.permission.INTERNET`
- `android.permission.ACCESS_NETWORK_STATE`

C·∫•u h√¨nh D·ªãch v·ª• Tr·ª£ nƒÉng:
```xml
<service
    android:name=".ui.component.service.MyAccessibilityService"
    android:permission="android.permission.BIND_ACCESSIBILITY_SERVICE"
    android:exported="true">
    <intent-filter>
        <action android:name="android.accessibilityservice.AccessibilityService" />
    </intent-filter>
    <meta-data
        android:name="android.accessibilityservice"
        android:resource="@xml/accessibility_service_config"/>
</service>
```

### ‚ö†Ô∏è Nguy C∆° B·∫£o M·∫≠t
- **Quy·ªÅn Accessibility m·∫°nh m·∫Ω**:
  - Accessibility Service cho ph√©p ·ª©ng d·ª•ng ghi l·∫°i thao t√°c ng∆∞·ªùi d√πng (keylog), ƒë·ªçc n·ªôi dung m√†n h√¨nh v√† ƒëi·ªÅu khi·ªÉn thi·∫øt b·ªã.
  - N·∫øu b·ªã l·∫°m d·ª•ng, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ thu th·∫≠p d·ªØ li·ªáu nh·∫°y c·∫£m (m·∫≠t kh·∫©u, tin nh·∫Øn) ho·∫∑c th·ª±c hi·ªán h√†nh ƒë·ªông kh√¥ng mong mu·ªën.
- **Firebase Realtime Database**:
  - D·ªØ li·ªáu truy·ªÅn qua Firebase (l·ªánh, keylog) kh√¥ng ƒë∆∞·ª£c m√£ h√≥a trong phi√™n b·∫£n demo, d·ªÖ b·ªã ch·∫∑n b·∫Øt ho·∫∑c s·ª≠a ƒë·ªïi.
- **Thi·∫øu x√°c th·ª±c**:
  - D·ª± √°n kh√¥ng tri·ªÉn khai c∆° ch·∫ø x√°c th·ª±c ng∆∞·ªùi d√πng ho·∫∑c thi·∫øt b·ªã, d·∫´n ƒë·∫øn nguy c∆° l·ªánh gi·∫£ m·∫°o t·ª´ ngu·ªìn kh√¥ng ƒë√°ng tin.

---

## üìã V√≠ D·ª• L·ªánh JSON T·ª´ Xa

D∆∞·ªõi ƒë√¢y l√† m·ªôt l·ªánh JSON m·∫´u ƒë·ªÉ minh h·ªça kh·∫£ nƒÉng ƒëi·ªÅu khi·ªÉn v√† ghi l·∫°i d·ªØ li·ªáu:

```json
{
  "type": "EXECUTE_ACTIONS",
  "actions": [
    {
      "action_type": "OPEN_APP",
      "target_type": "PACKAGE",
      "target_value": "com.example.bank"
    },
    {
      "action_type": "WAIT",
      "duration_ms": 3000
    },

    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/username_input",
      "input_text": "admin"
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/password_input",
      "input_text": "123456"
    },

    {
      "action_type": "CLICK",
      "target_type": "ID",
      "target_value": "com.example.bank:id/login_button"
    },
    {
      "action_type": "WAIT",
      "duration_ms": 5000
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/recipient_input",
      "input_text": "987654321"
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/amount_input",
      "input_text": "1000000"
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/note_input",
      "input_text": "Chuy·ªÉn ti·ªÅn t·ª± ƒë·ªông"
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/otp_1",
      "input_text": "1"
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/otp_2",
      "input_text": "2"
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/otp_3",
      "input_text": "3"
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/otp_4",
      "input_text": "4"
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/otp_5",
      "input_text": "5"
    },
    {
      "action_type": "INPUT",
      "target_type": "ID",
      "target_value": "com.example.bank:id/otp_6",
      "input_text": "6"
    },
    {
      "action_type": "CLICK",
      "target_type": "ID",
      "target_value": "com.example.bank:id/transfer_button"
    }
  ]
}

```

Trong k·ªãch b·∫£n n√†y, ·ª©ng d·ª•ng m·ªü m·ªôt ·ª©ng d·ª•ng, nh·∫≠p vƒÉn b·∫£n, nh·∫•p n√∫t v√† t·∫°m d·ª´ng. C√°c thao t√°c nh·∫≠p li·ªáu (keylog) s·∫Ω ƒë∆∞·ª£c g·ª≠i v·ªÅ Firebase, minh h·ªça nguy c∆° l·ªô d·ªØ li·ªáu.

---

## üß† ƒêi·ªÉm N·ªïi B·∫≠t K·ªπ Thu·∫≠t

- **Th·ª±c thi tu·∫ßn t·ª±**: H√†nh ƒë·ªông ƒë∆∞·ª£c th·ª±c hi·ªán c√≥ th·ª© t·ª± v·ªõi ƒë·ªô tr·ªÖ c·ªë ƒë·ªãnh, ƒë·∫£m b·∫£o t√≠nh ch√≠nh x√°c.
- **Ghi nh·∫≠t k√Ω th·ªùi gian th·ª±c**: L·ªói v√† tr·∫°ng th√°i ƒë∆∞·ª£c g·ª≠i v·ªÅ Firebase, h·ªó tr·ª£ g·ª° l·ªói hi·ªáu qu·∫£.
- **M√¥ ph·ªèng r·ªßi ro b·∫£o m·∫≠t**: Keylog v√† ƒëi·ªÅu khi·ªÉn t·ª´ xa cho th·∫•y nguy c∆° khi quy·ªÅn Accessibility b·ªã l·∫°m d·ª•ng.
- **D·ªÖ m·ªü r·ªông**: C·∫•u tr√∫c m√£ ngu·ªìn cho ph√©p th√™m c√°c lo·∫°i h√†nh ƒë·ªông m·ªõi m√† kh√¥ng c·∫ßn s·ª≠a ƒë·ªïi nhi·ªÅu.

---

## üìä D·ªØ Li·ªáu G·ª≠i V·ªÅ Server

| Ph∆∞∆°ng Th·ª©c         | Node Firebase | M·ª•c ƒê√≠ch                              |
|---------------------|---------------|---------------------------------------|
| `sendStatus()`      | `status`      | C·∫≠p nh·∫≠t tr·∫°ng th√°i thi·∫øt b·ªã           |
| `sendLog()`         | `logs`        | Ghi l·∫°i nh·∫≠t k√Ω ho·∫°t ƒë·ªông             |
| `sendKeyLog()`      | `keylog`      | L∆∞u thao t√°c nh·∫≠p li·ªáu ng∆∞·ªùi d√πng      |
| `sendLogNoti()`     | `lognoti`     | Ghi l·∫°i th√¥ng b√°o t·ª´ thi·∫øt b·ªã         |

---

## ‚úÖ H∆∞·ªõng Ph√°t Tri·ªÉn & ƒê·ªÅ Xu·∫•t B·∫£o M·∫≠t

### C·∫£i Ti·∫øn Ch·ª©c NƒÉng
- **Ph·∫£n h·ªìi chi ti·∫øt**: G·ª≠i tr·∫°ng th√°i sau m·ªói h√†nh ƒë·ªông ƒë·ªÉ theo d√µi ch√≠nh x√°c h∆°n.
- **Giao di·ªán c·∫•u h√¨nh**: T·∫°o UI ƒë·ªÉ ng∆∞·ªùi d√πng thi·∫øt l·∫≠p k·∫øt n·ªëi Firebase.
- **H·ªó tr·ª£ h√†nh ƒë·ªông m·ªõi**: Th√™m c√°c thao t√°c nh∆∞ vu·ªët, pinch-zoom.

### Bi·ªán Ph√°p B·∫£o M·∫≠t
- **M√£ h√≥a d·ªØ li·ªáu**: S·ª≠ d·ª•ng HTTPS v√† m√£ h√≥a AES cho d·ªØ li·ªáu truy·ªÅn qua Firebase.
- **X√°c th·ª±c m·∫°nh**: Y√™u c·∫ßu x√°c th·ª±c thi·∫øt b·ªã v√† ng∆∞·ªùi d√πng tr∆∞·ªõc khi x·ª≠ l√Ω l·ªánh.
- **Gi·ªõi h·∫°n quy·ªÅn**:
  - Ch·ªâ c·∫•p quy·ªÅn Accessibility khi th·ª±c s·ª± c·∫ßn thi·∫øt.
  - Th√¥ng b√°o ng∆∞·ªùi d√πng r√µ r√†ng v·ªÅ c√°c r·ªßi ro khi c·∫•p quy·ªÅn.
- **Ki·ªÉm tra m√£ ngu·ªìn**: Qu√©t m√£ ƒë·ªÉ ph√°t hi·ªán l·ªó h·ªïng b·∫£o m·∫≠t tr∆∞·ªõc khi tri·ªÉn khai.
- **Gi√°m s√°t b·∫•t th∆∞·ªùng**: Ph√°t hi·ªán v√† ch·∫∑n c√°c l·ªánh b·∫•t th∆∞·ªùng t·ª´ Firebase.

---

## üßë‚Äçüíª Nh√≥m Ph√°t Tri·ªÉn

**Nh√≥m 7**  
- Thi·∫øt k·∫ø v√† ph√°t tri·ªÉn h·ªá th·ªëng ƒëi·ªÅu khi·ªÉn t·ª´ xa v·ªõi t√≠nh nƒÉng keylog.  
- T√≠ch h·ª£p Firebase v√† Accessibility Service ƒë·ªÉ minh h·ªça c√°c v·∫•n ƒë·ªÅ b·∫£o m·∫≠t.  
- Chu·∫©n b·ªã demo cho m√¥n h·ªçc **An To√†n B·∫£o M·∫≠t Th√¥ng Tin**.

---

## üìú K·∫øt Lu·∫≠n

D·ª± √°n **Dynamic Island: Edge Lighting** cung c·∫•p m·ªôt n·ªÅn t·∫£ng tr·ª±c quan ƒë·ªÉ minh h·ªça c√°c nguy c∆° b·∫£o m·∫≠t li√™n quan ƒë·∫øn D·ªãch v·ª• Tr·ª£ nƒÉng v√† truy·ªÅn d·ªØ li·ªáu kh√¥ng an to√†n. Th√¥ng qua t√≠nh nƒÉng ƒëi·ªÅu khi·ªÉn t·ª´ xa v√† keylog, d·ª± √°n l√†m r√µ c√°ch d·ªØ li·ªáu nh·∫°y c·∫£m c√≥ th·ªÉ b·ªã thu th·∫≠p n·∫øu quy·ªÅn m·∫°nh b·ªã l·∫°m d·ª•ng. V·ªõi ki·∫øn tr√∫c r√µ r√†ng v√† kh·∫£ nƒÉng m·ªü r·ªông, ƒë√¢y l√† m·ªôt c√¥ng c·ª• h·ªØu √≠ch ƒë·ªÉ th·∫£o lu·∫≠n v·ªÅ an to√†n th√¥ng tin, ƒë·ªìng th·ªùi ƒë·∫∑t n·ªÅn t·∫£ng cho c√°c c·∫£i ti·∫øn b·∫£o m·∫≠t trong t∆∞∆°ng lai.

---
